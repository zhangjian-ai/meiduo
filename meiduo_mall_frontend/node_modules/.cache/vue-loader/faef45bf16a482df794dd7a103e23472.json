{"remainingRequest":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/src/views/Cart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/src/views/Cart.vue","mtime":1623820811526},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qIGVzbGludC1kaXNhYmxlICovCmltcG9ydCBDb250YWluZXIgZnJvbSAiQC9jb21wb25lbnRzL0NvbnRhaW5lci52dWUiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJDYXJ0IiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g5p+l6K+i57uT5p6cCiAgICAgIHNrdXM6IFtdLAoKICAgICAgLy8g5omA5pyJ5ZWG5ZOB5oC75Lu35Y+K5pWw6YePCiAgICAgIHRvdGFsX3ByaWNlOiAwLAogICAgICBjb3VudDogMCwKCiAgICAgIC8vIOmAieS4reeahHNrdQogICAgICBzZWxlY3RlZF9za3VzOiBbXQogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldF9jYXJ0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDojrflj5botK3nianovabkv6Hmga8KICAgIGdldF9jYXJ0KCkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIHRoYXQuJGF4aW9zLmdldCgiY2FydC8iKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhhdC5za3VzID0gcmVzLmRhdGE7CiAgICAgIH0pOwogICAgfSwKCiAgICAvLyDli77pgInkuovku7YKICAgIGhhbmRsZVNlbGVjdGlvbkNoYW5nZShyb3dzKSB7CiAgICAgIHRoaXMuY291bnQgPSAwOwogICAgICB0aGlzLnRvdGFsX3ByaWNlID0gMDsKICAgICAgdGhpcy5zZWxlY3RlZF9za3VzID0gcm93czsKICAgICAgcm93cy5mb3JFYWNoKHZhbHVlID0+IHsKICAgICAgICB0aGlzLnRvdGFsX3ByaWNlICs9IHZhbHVlLmNvdW50ICogdmFsdWUucHJpY2U7CiAgICAgICAgdGhpcy5jb3VudCArPSB2YWx1ZS5jb3VudDsKICAgICAgfSk7CiAgICB9LAoKICAgIC8vIOihqOagvOihjOeCueWHu+S6i+S7tu+8jOeCueWHu+ihjOWwseWPlua2iOWLvumAieeKtuaAgeW5tueri+WNs+WGjeasoeWLvumAie+8jOS4uuS6huWHuuWPkWhhbmRsZVNlbGVjdGlvbkNoYW5nZQogICAgaGFuZGxlUm93Q2xpY2socm93KSB7CiAgICAgIHRoaXMuJHJlZnMuc2t1TGlzdC50b2dnbGVSb3dTZWxlY3Rpb24ocm93LCBmYWxzZSk7CiAgICAgIC8vIHRoaXMuJHJlZnMuc2t1TGlzdC50b2dnbGVSb3dTZWxlY3Rpb24ocm93LCB0cnVlKTsKICAgIH0sCgogICAgLy8g5L+u5pS56LSt54mp6L2m5L+h5oGv77yMIOWIqeeUqGFzeW5jIOWSjCBhd2FpdCDlrp7njrDlkIzmraXor7fmsYIKICAgIGVkaXRfY2FydDogZnVuY3Rpb24ocm93KSB7CiAgICAgIC8vIOWHhuWkh+aVsOaNrgogICAgICBsZXQgcmVxdWVzdF9kYXRhID0gewogICAgICAgIHNrdV9pZDogcm93LmlkLAogICAgICAgIGNvdW50OiByb3cuY291bnQsCiAgICAgICAgc3BlYzogcm93LnNwZWMKICAgICAgfTsKCiAgICAgIHRoaXMuJGF4aW9zLnB1dCgiY2FydC8iLCB7CiAgICAgICAgZGF0YTogcmVxdWVzdF9kYXRhCiAgICAgIH0pOwogICAgfSwKCiAgICAvLyDliKDpmaTotK3nianovaborrDlvZUKICAgIGRlbGV0ZV9jYXJ0KHJvdykgewogICAgICB0aGlzLiRheGlvcwogICAgICAgIC5kZWxldGUoImNhcnQvIiwgewogICAgICAgICAgZGF0YTogcm93CiAgICAgICAgfSkKICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICAgIHRoaXMuZ2V0X2NhcnQoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCgogICAgLy8g6Lez6L2s6Iez5o+Q5Lqk6K6i5Y2V6aG16Z2iCiAgICB0b19jcmVhdGVfb3JkZXIoKSB7CiAgICAgIGlmICh0aGlzLnNlbGVjdGVkX3NrdXMubGVuZ3RoID09IDApIHsKICAgICAgICB0aGlzLiRub3RpZnkud2FybmluZyh7CiAgICAgICAgICB0aXRsZTogIuivt+WFiOmAieaLqemcgOimgei0reS5sOeahOWVhuWTgSIKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLnRva2VuID09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuJG5vdGlmeS53YXJuaW5nKHsKICAgICAgICAgIHRpdGxlOiAi6K+35YWI55m76ZmGIgogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8g5YeG5aSH5pWw5o2uCiAgICAgIGxldCByZXF1ZXN0X2RhdGEgPSBbXTsKICAgICAgdGhpcy5zZWxlY3RlZF9za3VzLmZvckVhY2goKHZhbHVlLCBpbmRleCkgPT4gewogICAgICAgIGxldCBza3UgPSB7fTsKICAgICAgICBza3Uuc2t1X2lkID0gdmFsdWUuaWQ7CiAgICAgICAgc2t1LnNwZWMgPSB2YWx1ZS5zcGVjOwoKICAgICAgICByZXF1ZXN0X2RhdGFbaW5kZXhdID0gc2t1OwogICAgICB9KTsKICAgICAgbGV0IHBhcmFtcyA9IHsgc2t1czogcmVxdWVzdF9kYXRhIH07CgogICAgICB0aGlzLiRhcGkuc2VsZWN0cyhwYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDEpIHsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgbmFtZTogImNyZWF0ZV9vcmRlciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBDb250YWluZXIKICB9LAogIHdhdGNoOiB7fQp9Owo="},{"version":3,"sources":["Cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Cart.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <Container>\n    <el-divider></el-divider>\n    <el-row>\n      <el-col :span=\"2\">\n        <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n      </el-col>\n      <el-col :span=\"20\">\n        <div class=\"title\">\n          <p style=\"font-size: 1.2em; color: red;\">\n            <span class=\"el-icon-shopping-cart-full\">商品清单</span>\n          </p>\n        </div>\n      </el-col>\n    </el-row>\n    <!-- 详情展示区 -->\n    <el-row>\n      <el-col :span=\"2\">\n        <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n      </el-col>\n      <el-col :span=\"20\">\n        <div class=\"detail\">\n          <div>\n            <!-- 商品展示 -->\n            <el-table\n              :data=\"skus\"\n              size=\"mini\"\n              height=\"40em\"\n              highlight-cuurent-row\n              ref=\"skuList\"\n              :header-cell-style=\"{background:'#eef1f6',color:'#606266'}\"\n              :header-row-style=\"{height:'5em'}\"\n              @selection-change=\"handleSelectionChange\"\n              @row-click=\"handleRowClick\"\n            >\n              <el-table-column type=\"selection\" align=\"center\"></el-table-column>\n              <el-table-column width=\"150\" align=\"center\">\n                <template slot-scope=\"scope\">\n                  <el-image :src=\"scope.row.default_image_url\" style=\"width: 8em; height: 8em;\"></el-image>\n                </template>\n              </el-table-column>\n              <el-table-column prop=\"name\" label=\"商品名称\" width=\"300\" align=\"center\"></el-table-column>\n              <el-table-column prop=\"spec\" label=\"规格\" width=\"150\" align=\"center\"></el-table-column>\n              <el-table-column prop=\"price\" label=\"价格\" width=\"100\" align=\"center\"></el-table-column>\n              <el-table-column label=\"数量\" width=\"180\" align=\"center\">\n                <template slot-scope=\"scope\">\n                  <el-input-number\n                    v-model=\"scope.row.count\"\n                    :min=\"1\"\n                    :max=\"scope.row.stock\"\n                    size=\"mini\"\n                    @change=\"edit_cart(scope.row)\"\n                  ></el-input-number>\n                </template>\n              </el-table-column>\n              <el-table-column label=\"小计\" width=\"120\" align=\"center\">\n                <!-- 保留两位小数 -->\n                <template\n                  slot-scope=\"scope\"\n                >{{ (scope.row.count * scope.row.price).toFixed(2) }} &nbsp;元</template>\n              </el-table-column>\n              <el-table-column label=\"操作\" align=\"center\">\n                <template slot-scope=\"scope\">\n                  <el-button\n                    type=\"danger\"\n                    icon=\"el-icon-delete\"\n                    size=\"mini\"\n                    @click=\"delete_cart(scope.row)\"\n                  >删除</el-button>\n                </template>\n              </el-table-column>\n            </el-table>\n          </div>\n          <!-- 结算栏 -->\n          <div class=\"account\">\n            <el-col :span=\"15\">\n              <el-col :span=\"2\">\n                <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n              </el-col>\n              <el-col :span=\"4\">\n                <p style=\"font-size: 1.5em;color: red;\">结&nbsp;算</p>\n              </el-col>\n            </el-col>\n            <el-col :span=\"4\">\n              <p style=\"text-align: right;\">\n                <span style=\"font-size: 0.5em;\">合计（不含运费）：</span>\n                <span style=\"font-size: 0.5em; color: red;\">¥ &nbsp;</span>\n                <span style=\"font-size: 1.2em; color: red;\">{{ total_price }}</span>\n              </p>\n              <p style=\"font-size: 0.5em; text-align: right;\">\n                <span>共计</span>\n                <span style=\"color: red;\">&nbsp;{{ count }}&nbsp;</span>\n                <span>件商品</span>\n              </p>\n            </el-col>\n            <el-col :span=\"1\">\n              <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n            </el-col>\n            <el-col :span=\"4\">\n              <div class=\"submit_button\">\n                <el-link\n                  style=\"color: white; font-size: 1.2em;\"\n                  :underline=\"false\"\n                  @click=\"to_create_order\"\n                >立&nbsp;即&nbsp;付&nbsp;款</el-link>\n              </div>\n            </el-col>\n          </div>\n        </div>\n      </el-col>\n    </el-row>\n  </Container>\n</template>\n<script>\n/* eslint-disable */\nimport Container from \"@/components/Container.vue\";\n\nexport default {\n  name: \"Cart\",\n  data() {\n    return {\n      // 查询结果\n      skus: [],\n\n      // 所有商品总价及数量\n      total_price: 0,\n      count: 0,\n\n      // 选中的sku\n      selected_skus: []\n    };\n  },\n  mounted() {\n    this.get_cart();\n  },\n  methods: {\n    // 获取购物车信息\n    get_cart() {\n      let that = this;\n      that.$axios.get(\"cart/\").then(res => {\n        that.skus = res.data;\n      });\n    },\n\n    // 勾选事件\n    handleSelectionChange(rows) {\n      this.count = 0;\n      this.total_price = 0;\n      this.selected_skus = rows;\n      rows.forEach(value => {\n        this.total_price += value.count * value.price;\n        this.count += value.count;\n      });\n    },\n\n    // 表格行点击事件，点击行就取消勾选状态并立即再次勾选，为了出发handleSelectionChange\n    handleRowClick(row) {\n      this.$refs.skuList.toggleRowSelection(row, false);\n      // this.$refs.skuList.toggleRowSelection(row, true);\n    },\n\n    // 修改购物车信息， 利用async 和 await 实现同步请求\n    edit_cart: function(row) {\n      // 准备数据\n      let request_data = {\n        sku_id: row.id,\n        count: row.count,\n        spec: row.spec\n      };\n\n      this.$axios.put(\"cart/\", {\n        data: request_data\n      });\n    },\n\n    // 删除购物车记录\n    delete_cart(row) {\n      this.$axios\n        .delete(\"cart/\", {\n          data: row\n        })\n        .then(res => {\n          if (res.status == 200) {\n            this.get_cart();\n          }\n        });\n    },\n\n    // 跳转至提交订单页面\n    to_create_order() {\n      if (this.selected_skus.length == 0) {\n        this.$notify.warning({\n          title: \"请先选择需要购买的商品\"\n        });\n        return;\n      }\n      if (this.$store.state.token == undefined) {\n        this.$notify.warning({\n          title: \"请先登陆\"\n        });\n        return;\n      }\n\n      // 准备数据\n      let request_data = [];\n      this.selected_skus.forEach((value, index) => {\n        let sku = {};\n        sku.sku_id = value.id;\n        sku.spec = value.spec;\n\n        request_data[index] = sku;\n      });\n      let params = { skus: request_data };\n\n      this.$api.selects(params).then(res => {\n        if (res.status == 201) {\n          this.$router.push({\n            name: \"create_order\"\n          });\n        }\n      });\n    }\n  },\n  components: {\n    Container\n  },\n  watch: {}\n};\n</script>\n<style  scoped>\n.el-divider {\n  margin: 0;\n  padding: 0;\n  width: 85%;\n  margin-left: 6.5em;\n}\n.el-row {\n  margin: 0 0;\n}\n.detail {\n  height: 35em;\n  background-color: rgb(248, 219, 156);\n}\n.submit_button {\n  background-color: rgb(236, 62, 62);\n  height: 5em;\n  line-height: 5em;\n  text-align: center;\n}\n</style>"]}]}