{"remainingRequest":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/src/views/SkuDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/src/views/SkuDetail.vue","mtime":1624032644245},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qIGVzbGludC1kaXNhYmxlICovCmltcG9ydCBDb250YWluZXIgZnJvbSAiQC9jb21wb25lbnRzL0NvbnRhaW5lci52dWUiOwppbXBvcnQgQ2F0ZWdvcnkgZnJvbSAiQC9jb21wb25lbnRzL0NhdGVnb3J5LnZ1ZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlNrdURldGFpbCIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8vIOafpeivoue7k+aenAogICAgICBza3VfZGF0YToge30sCgogICAgICAvLyBza3VfaWQKICAgICAgc2t1X2lkOiAxLAoKICAgICAgLy8g5pWw6YePCiAgICAgIG51bTogMSwKCiAgICAgIC8vIOinhOagvOmAieaLqeaVsOe7hAogICAgICBjaG9pY2U6IFtdLAoKICAgICAgLy8g5oC75Lu3CiAgICAgIGZpbmFsX3ByaWNlOiAwLAoKICAgICAgLy8g5ZWG5ZOB5bqT5a2Y5Li6MOaXtu+8jOWkseaViOi0reS5sOWSjOWKoOWFpei0reeJqei9puaMiemSrgogICAgICBzdGF0dXM6IGZhbHNlCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuc2t1X2lkID0gdGhpcy4kcm91dGUucXVlcnkuc2t1X2lkOwogICAgdGhpcy5nZXRfc2t1X2RldGFpbCgpOwogICAgdGhpcy5zZXRfaGlzdG9yeSgpOwogIH0sCiAgbWV0aG9kczogewogICAgLy8g6I635Y+Wc2t16K+m5oOF5pWw5o2uCiAgICBnZXRfc2t1X2RldGFpbCgpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICB0aGF0LiRheGlvcy5nZXQoInNrdV9kZXRhaWwvIiArIHRoYXQuc2t1X2lkICsgIi8iKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhhdC5za3VfZGF0YSA9IHJlcy5kYXRhOwogICAgICAgIHRoYXQuZmluYWxfcHJpY2UgPSB0aGF0LnNrdV9kYXRhLnByaWNlOwogICAgICAgIGlmICh0aGF0LnNrdV9kYXRhLnN0b2NrID09IDApIHsKICAgICAgICAgIHRoYXQuc3RhdHVzID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOa3u+WKoOi0reeJqei9pgogICAgYWRkX2NhcnQoKSB7CiAgICAgIGlmICh0aGlzLiRhcGkuY2hlY2tfc3BlYyh0aGlzLmNob2ljZSwgdGhpcy5za3VfZGF0YS5zcGVjcykpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6ICLor7flhYjpgInmi6nllYblk4Hop4TmoLwiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIHRoYXQuJGF4aW9zCiAgICAgICAgLnBvc3QoImNhcnQvIiwgewogICAgICAgICAgc2t1X2lkOiB0aGF0LnNrdV9pZCwKICAgICAgICAgIGNvdW50OiB0aGF0Lm51bSwKICAgICAgICAgIHNwZWM6IHRoYXQuY2hvaWNlLmpvaW4oIl8iKQogICAgICAgIH0pCiAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgIHRoYXQuJG5vdGlmeSh7CiAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgdGl0bGU6ICLmt7vliqDotK3nianovabmiJDlip8iCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0sCgogICAgLy8g56uL5Y2z6LSt5LmwCiAgICBidXlfbm93KCkgewogICAgICBpZiAodGhpcy4kYXBpLmNoZWNrX3NwZWModGhpcy5jaG9pY2UsIHRoaXMuc2t1X2RhdGEuc3BlY3MpKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICBtZXNzYWdlOiAi6K+35YWI6YCJ5oup5ZWG5ZOB6KeE5qC8IiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLnRva2VuID09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuJG5vdGlmeS53YXJuaW5nKHsKICAgICAgICAgIHRpdGxlOiAi6K+35YWI55m76ZmGIgogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIHRoYXQuJGF4aW9zCiAgICAgICAgLnBvc3QoImNhcnQvIiwgewogICAgICAgICAgc2t1X2lkOiB0aGF0LnNrdV9pZCwKICAgICAgICAgIGNvdW50OiB0aGF0Lm51bSwKICAgICAgICAgIHNwZWM6IHRoYXQuY2hvaWNlLmpvaW4oIl8iKQogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgLy8g5YeG5aSH5pWw5o2uCiAgICAgICAgICBsZXQgcmVxdWVzdF9kYXRhID0gW107CiAgICAgICAgICByZXF1ZXN0X2RhdGFbMF0gPSB7CiAgICAgICAgICAgIHNrdV9pZDogdGhhdC5za3VfaWQsCiAgICAgICAgICAgIHNwZWM6IHRoYXQuY2hvaWNlLmpvaW4oIl8iKQogICAgICAgICAgfTsKICAgICAgICAgIGxldCBwYXJhbXMgPSB7IHNrdXM6IHJlcXVlc3RfZGF0YSB9OwoKICAgICAgICAgIHRoYXQuJGFwaS5zZWxlY3RzKHBhcmFtcykudGhlbihyZXMgPT4gewogICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDEpIHsKICAgICAgICAgICAgICB0aGF0LiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICBuYW1lOiAiY3JlYXRlX29yZGVyIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0sCgogICAgLy8g5L+d5a2Y5rWP6KeI6K6w5b2VCiAgICBzZXRfaGlzdG9yeSgpIHsKICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLnRva2VuKSB7CiAgICAgICAgdGhpcy4kYXhpb3MucG9zdCgic2V0X2hpc3RvcnkvIiwgewogICAgICAgICAgc2t1X2lkOiB0aGlzLnNrdV9pZAogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIENvbnRhaW5lciwKICAgIENhdGVnb3J5CiAgfSwKICB3YXRjaDogewogICAgbnVtOiBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5maW5hbF9wcmljZSA9IHRoaXMuc2t1X2RhdGEucHJpY2UgKiB0aGlzLm51bTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["SkuDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8FA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SkuDetail.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <Container>\n    <Category></Category>\n    <!-- 详情展示区 -->\n    <el-row>\n      <el-col :span=\"2\">\n        <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n      </el-col>\n      <el-col :span=\"20\">\n        <div class=\"detail\">\n          <!-- 图片展示 -->\n          <el-col :span=\"8\">\n            <div class=\"image\">\n              <el-image :src=\"sku_data.default_image_url\"></el-image>\n            </div>\n            <div class=\"img-list\">\n              <el-scrollbar>\n                <ul>\n                  <li v-for=\"item in sku_data.images\" :key=\"item.image\">\n                    <el-popover placement=\"top\" trigger=\"hover\">\n                      <img :src=\"item.image\" style=\"height: 30em;width: 30em\" />\n                      <img\n                        slot=\"reference\"\n                        :src=\"item.image\"\n                        style=\"max-height: 3em;max-width: 3em\"\n                      />\n                    </el-popover>\n                  </li>\n                </ul>\n              </el-scrollbar>\n            </div>\n          </el-col>\n          <el-col :span=\"2\">\n            <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n          </el-col>\n          <!-- 规格详情 -->\n          <el-col :span=\"14\">\n            <div class=\"text\">\n              <div>\n                <p style=\"font-size: 1.5em;\">{{ sku_data.name }}</p>\n                <span style=\"font-size: 0.2em; color: grey;\">{{ sku_data.caption }}</span>\n              </div>\n              <div class=\"price\">\n                <p style=\"height: 4em; line-height:4em;\">\n                  <span style=\"font-size: 2em; color:red; margin-left: 0.5em;\">{{ sku_data.price }}</span>\n                  <span style=\"font-size: 0.2em; margin-left: 10em;\">市场价：{{ sku_data.market_price }}</span>\n                  <span\n                    style=\"font-size: 0.2em; margin-left: 60em; color: grey;\"\n                  >{{ sku_data.comments }} 条评价</span>\n                </p>\n              </div>\n              <div>\n                <span>数量：</span>\n                <el-input-number v-model=\"num\" :min=\"1\" :max=\"sku_data.stock\" size=\"mini\"></el-input-number>\n                <span\n                  style=\"font-size: 0.2em; margin-left: 15em; color: grey;\"\n                >剩余库存：{{ sku_data.stock }}</span>\n              </div>\n              <div v-for=\"(spec, index) in sku_data.specs\" :key=\"spec.name\">\n                <span>{{ spec.name }}：&nbsp;</span>\n                <el-radio-group v-model=\"choice[index]\" size=\"mini\" fill=\"red\">\n                  <el-radio-button\n                    v-for=\"value in spec.list\"\n                    :key=\"value\"\n                    :label=\"value\"\n                  >{{ value }}</el-radio-button>\n                </el-radio-group>\n              </div>\n              <div>\n                <span>总价：¥</span>\n                <span style=\"font-size: 2em; color:red; margin-left: 0.5em;\">{{ final_price }}</span>\n              </div>\n              <div style=\"margin-top: 2em;\">\n                <p>\n                  <el-button type=\"danger\" @click=\"buy_now()\" :disabled=\"status\">立即购买</el-button>\n                  <el-button type=\"danger\" plain @click=\"add_cart()\" :disabled=\"status\">加入购物车</el-button>\n                </p>\n              </div>\n            </div>\n          </el-col>\n        </div>\n      </el-col>\n    </el-row>\n    <!-- 其他信息：介绍，配件清单，售后 -->\n    <el-row>\n      <div class=\"description\" v-if=\"sku_data.desc\">\n        <div v-html=\"sku_data.desc.desc_detail\" style=\"text-align: center;\"></div>\n        <div v-html=\"sku_data.desc.desc_pack\"></div>\n        <div v-html=\"sku_data.desc.desc_service\"></div>\n      </div>\n    </el-row>\n  </Container>\n</template>\n<script>\n/* eslint-disable */\nimport Container from \"@/components/Container.vue\";\nimport Category from \"@/components/Category.vue\";\n\nexport default {\n  name: \"SkuDetail\",\n  data() {\n    return {\n      // 查询结果\n      sku_data: {},\n\n      // sku_id\n      sku_id: 1,\n\n      // 数量\n      num: 1,\n\n      // 规格选择数组\n      choice: [],\n\n      // 总价\n      final_price: 0,\n\n      // 商品库存为0时，失效购买和加入购物车按钮\n      status: false\n    };\n  },\n  mounted() {\n    this.sku_id = this.$route.query.sku_id;\n    this.get_sku_detail();\n    this.set_history();\n  },\n  methods: {\n    // 获取sku详情数据\n    get_sku_detail() {\n      let that = this;\n      that.$axios.get(\"sku_detail/\" + that.sku_id + \"/\").then(res => {\n        that.sku_data = res.data;\n        that.final_price = that.sku_data.price;\n        if (that.sku_data.stock == 0) {\n          that.status = true;\n        }\n      });\n    },\n    // 添加购物车\n    add_cart() {\n      if (this.$api.check_spec(this.choice, this.sku_data.specs)) {\n        this.$message({\n          message: \"请先选择商品规格\",\n          type: \"warning\",\n        });\n        return;\n      }\n      let that = this;\n      that.$axios\n        .post(\"cart/\", {\n          sku_id: that.sku_id,\n          count: that.num,\n          spec: that.choice.join(\"_\")\n        })\n        .then(res => {\n          that.$notify({\n            type: \"success\",\n            title: \"添加购物车成功\"\n          });\n        });\n    },\n\n    // 立即购买\n    buy_now() {\n      if (this.$api.check_spec(this.choice, this.sku_data.specs)) {\n        this.$message({\n          message: \"请先选择商品规格\",\n          type: \"warning\",\n        });\n        return;\n      }\n      if (this.$store.state.token == undefined) {\n        this.$notify.warning({\n          title: \"请先登陆\"\n        });\n        return;\n      }\n      let that = this;\n      that.$axios\n        .post(\"cart/\", {\n          sku_id: that.sku_id,\n          count: that.num,\n          spec: that.choice.join(\"_\")\n        })\n        .then(() => {\n          // 准备数据\n          let request_data = [];\n          request_data[0] = {\n            sku_id: that.sku_id,\n            spec: that.choice.join(\"_\")\n          };\n          let params = { skus: request_data };\n\n          that.$api.selects(params).then(res => {\n            if (res.status == 201) {\n              that.$router.push({\n                name: \"create_order\"\n              });\n            }\n          });\n        });\n    },\n\n    // 保存浏览记录\n    set_history() {\n      if (this.$store.state.token) {\n        this.$axios.post(\"set_history/\", {\n          sku_id: this.sku_id\n        });\n      }\n      return;\n    }\n  },\n  components: {\n    Container,\n    Category\n  },\n  watch: {\n    num: function() {\n      this.final_price = this.sku_data.price * this.num;\n    }\n  }\n};\n</script>\n<style  scoped>\n.detail {\n  height: 35em;\n}\n.image {\n  width: 24em;\n  height: 24em;\n  margin-top: 2em;\n  margin-bottom: 2em;\n}\n.img-list {\n  background-color: rgb(199, 193, 193);\n  border-radius: 0.5em;\n}\nul {\n  display: flex;\n}\nli {\n  display: inline-block;\n  flex-shrink: 0;\n  margin: 0 1em;\n  padding: 0 0;\n}\n\n.text {\n  text-align: left;\n  width: 40em;\n}\n\n.text div {\n  margin: 1em 0;\n}\n\n.price {\n  background-color: rgb(235, 225, 230);\n}\n\n.description {\n  width: 80%;\n  margin-left: 6em;\n  padding: 1em 3em;\n  background-color: rgb(131, 157, 179);\n  border-radius: 1em;\n}\n</style>"]}]}