{"remainingRequest":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/src/views/SkuDetail.vue?vue&type=style&index=0&id=47db0402&scoped=true&lang=css&","dependencies":[{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/src/views/SkuDetail.vue","mtime":1624032644245},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmRldGFpbCB7CiAgaGVpZ2h0OiAzNWVtOwp9Ci5pbWFnZSB7CiAgd2lkdGg6IDI0ZW07CiAgaGVpZ2h0OiAyNGVtOwogIG1hcmdpbi10b3A6IDJlbTsKICBtYXJnaW4tYm90dG9tOiAyZW07Cn0KLmltZy1saXN0IHsKICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMTk5LCAxOTMsIDE5Myk7CiAgYm9yZGVyLXJhZGl1czogMC41ZW07Cn0KdWwgewogIGRpc3BsYXk6IGZsZXg7Cn0KbGkgewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICBmbGV4LXNocmluazogMDsKICBtYXJnaW46IDAgMWVtOwogIHBhZGRpbmc6IDAgMDsKfQoKLnRleHQgewogIHRleHQtYWxpZ246IGxlZnQ7CiAgd2lkdGg6IDQwZW07Cn0KCi50ZXh0IGRpdiB7CiAgbWFyZ2luOiAxZW0gMDsKfQoKLnByaWNlIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjM1LCAyMjUsIDIzMCk7Cn0KCi5kZXNjcmlwdGlvbiB7CiAgd2lkdGg6IDgwJTsKICBtYXJnaW4tbGVmdDogNmVtOwogIHBhZGRpbmc6IDFlbSAzZW07CiAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDEzMSwgMTU3LCAxNzkpOwogIGJvcmRlci1yYWRpdXM6IDFlbTsKfQo="},{"version":3,"sources":["SkuDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SkuDetail.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <Container>\n    <Category></Category>\n    <!-- 详情展示区 -->\n    <el-row>\n      <el-col :span=\"2\">\n        <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n      </el-col>\n      <el-col :span=\"20\">\n        <div class=\"detail\">\n          <!-- 图片展示 -->\n          <el-col :span=\"8\">\n            <div class=\"image\">\n              <el-image :src=\"sku_data.default_image_url\"></el-image>\n            </div>\n            <div class=\"img-list\">\n              <el-scrollbar>\n                <ul>\n                  <li v-for=\"item in sku_data.images\" :key=\"item.image\">\n                    <el-popover placement=\"top\" trigger=\"hover\">\n                      <img :src=\"item.image\" style=\"height: 30em;width: 30em\" />\n                      <img\n                        slot=\"reference\"\n                        :src=\"item.image\"\n                        style=\"max-height: 3em;max-width: 3em\"\n                      />\n                    </el-popover>\n                  </li>\n                </ul>\n              </el-scrollbar>\n            </div>\n          </el-col>\n          <el-col :span=\"2\">\n            <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n          </el-col>\n          <!-- 规格详情 -->\n          <el-col :span=\"14\">\n            <div class=\"text\">\n              <div>\n                <p style=\"font-size: 1.5em;\">{{ sku_data.name }}</p>\n                <span style=\"font-size: 0.2em; color: grey;\">{{ sku_data.caption }}</span>\n              </div>\n              <div class=\"price\">\n                <p style=\"height: 4em; line-height:4em;\">\n                  <span style=\"font-size: 2em; color:red; margin-left: 0.5em;\">{{ sku_data.price }}</span>\n                  <span style=\"font-size: 0.2em; margin-left: 10em;\">市场价：{{ sku_data.market_price }}</span>\n                  <span\n                    style=\"font-size: 0.2em; margin-left: 60em; color: grey;\"\n                  >{{ sku_data.comments }} 条评价</span>\n                </p>\n              </div>\n              <div>\n                <span>数量：</span>\n                <el-input-number v-model=\"num\" :min=\"1\" :max=\"sku_data.stock\" size=\"mini\"></el-input-number>\n                <span\n                  style=\"font-size: 0.2em; margin-left: 15em; color: grey;\"\n                >剩余库存：{{ sku_data.stock }}</span>\n              </div>\n              <div v-for=\"(spec, index) in sku_data.specs\" :key=\"spec.name\">\n                <span>{{ spec.name }}：&nbsp;</span>\n                <el-radio-group v-model=\"choice[index]\" size=\"mini\" fill=\"red\">\n                  <el-radio-button\n                    v-for=\"value in spec.list\"\n                    :key=\"value\"\n                    :label=\"value\"\n                  >{{ value }}</el-radio-button>\n                </el-radio-group>\n              </div>\n              <div>\n                <span>总价：¥</span>\n                <span style=\"font-size: 2em; color:red; margin-left: 0.5em;\">{{ final_price }}</span>\n              </div>\n              <div style=\"margin-top: 2em;\">\n                <p>\n                  <el-button type=\"danger\" @click=\"buy_now()\" :disabled=\"status\">立即购买</el-button>\n                  <el-button type=\"danger\" plain @click=\"add_cart()\" :disabled=\"status\">加入购物车</el-button>\n                </p>\n              </div>\n            </div>\n          </el-col>\n        </div>\n      </el-col>\n    </el-row>\n    <!-- 其他信息：介绍，配件清单，售后 -->\n    <el-row>\n      <div class=\"description\" v-if=\"sku_data.desc\">\n        <div v-html=\"sku_data.desc.desc_detail\" style=\"text-align: center;\"></div>\n        <div v-html=\"sku_data.desc.desc_pack\"></div>\n        <div v-html=\"sku_data.desc.desc_service\"></div>\n      </div>\n    </el-row>\n  </Container>\n</template>\n<script>\n/* eslint-disable */\nimport Container from \"@/components/Container.vue\";\nimport Category from \"@/components/Category.vue\";\n\nexport default {\n  name: \"SkuDetail\",\n  data() {\n    return {\n      // 查询结果\n      sku_data: {},\n\n      // sku_id\n      sku_id: 1,\n\n      // 数量\n      num: 1,\n\n      // 规格选择数组\n      choice: [],\n\n      // 总价\n      final_price: 0,\n\n      // 商品库存为0时，失效购买和加入购物车按钮\n      status: false\n    };\n  },\n  mounted() {\n    this.sku_id = this.$route.query.sku_id;\n    this.get_sku_detail();\n    this.set_history();\n  },\n  methods: {\n    // 获取sku详情数据\n    get_sku_detail() {\n      let that = this;\n      that.$axios.get(\"sku_detail/\" + that.sku_id + \"/\").then(res => {\n        that.sku_data = res.data;\n        that.final_price = that.sku_data.price;\n        if (that.sku_data.stock == 0) {\n          that.status = true;\n        }\n      });\n    },\n    // 添加购物车\n    add_cart() {\n      if (this.$api.check_spec(this.choice, this.sku_data.specs)) {\n        this.$message({\n          message: \"请先选择商品规格\",\n          type: \"warning\",\n        });\n        return;\n      }\n      let that = this;\n      that.$axios\n        .post(\"cart/\", {\n          sku_id: that.sku_id,\n          count: that.num,\n          spec: that.choice.join(\"_\")\n        })\n        .then(res => {\n          that.$notify({\n            type: \"success\",\n            title: \"添加购物车成功\"\n          });\n        });\n    },\n\n    // 立即购买\n    buy_now() {\n      if (this.$api.check_spec(this.choice, this.sku_data.specs)) {\n        this.$message({\n          message: \"请先选择商品规格\",\n          type: \"warning\",\n        });\n        return;\n      }\n      if (this.$store.state.token == undefined) {\n        this.$notify.warning({\n          title: \"请先登陆\"\n        });\n        return;\n      }\n      let that = this;\n      that.$axios\n        .post(\"cart/\", {\n          sku_id: that.sku_id,\n          count: that.num,\n          spec: that.choice.join(\"_\")\n        })\n        .then(() => {\n          // 准备数据\n          let request_data = [];\n          request_data[0] = {\n            sku_id: that.sku_id,\n            spec: that.choice.join(\"_\")\n          };\n          let params = { skus: request_data };\n\n          that.$api.selects(params).then(res => {\n            if (res.status == 201) {\n              that.$router.push({\n                name: \"create_order\"\n              });\n            }\n          });\n        });\n    },\n\n    // 保存浏览记录\n    set_history() {\n      if (this.$store.state.token) {\n        this.$axios.post(\"set_history/\", {\n          sku_id: this.sku_id\n        });\n      }\n      return;\n    }\n  },\n  components: {\n    Container,\n    Category\n  },\n  watch: {\n    num: function() {\n      this.final_price = this.sku_data.price * this.num;\n    }\n  }\n};\n</script>\n<style  scoped>\n.detail {\n  height: 35em;\n}\n.image {\n  width: 24em;\n  height: 24em;\n  margin-top: 2em;\n  margin-bottom: 2em;\n}\n.img-list {\n  background-color: rgb(199, 193, 193);\n  border-radius: 0.5em;\n}\nul {\n  display: flex;\n}\nli {\n  display: inline-block;\n  flex-shrink: 0;\n  margin: 0 1em;\n  padding: 0 0;\n}\n\n.text {\n  text-align: left;\n  width: 40em;\n}\n\n.text div {\n  margin: 1em 0;\n}\n\n.price {\n  background-color: rgb(235, 225, 230);\n}\n\n.description {\n  width: 80%;\n  margin-left: 6em;\n  padding: 1em 3em;\n  background-color: rgb(131, 157, 179);\n  border-radius: 1em;\n}\n</style>"]}]}