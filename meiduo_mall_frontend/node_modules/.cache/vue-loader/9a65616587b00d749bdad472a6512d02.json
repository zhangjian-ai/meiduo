{"remainingRequest":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/src/views/Cart.vue?vue&type=style&index=0&id=fd025920&scoped=true&lang=css&","dependencies":[{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/src/views/Cart.vue","mtime":1623820811526},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZWwtZGl2aWRlciB7CiAgbWFyZ2luOiAwOwogIHBhZGRpbmc6IDA7CiAgd2lkdGg6IDg1JTsKICBtYXJnaW4tbGVmdDogNi41ZW07Cn0KLmVsLXJvdyB7CiAgbWFyZ2luOiAwIDA7Cn0KLmRldGFpbCB7CiAgaGVpZ2h0OiAzNWVtOwogIGJhY2tncm91bmQtY29sb3I6IHJnYigyNDgsIDIxOSwgMTU2KTsKfQouc3VibWl0X2J1dHRvbiB7CiAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDIzNiwgNjIsIDYyKTsKICBoZWlnaHQ6IDVlbTsKICBsaW5lLWhlaWdodDogNWVtOwogIHRleHQtYWxpZ246IGNlbnRlcjsKfQo="},{"version":3,"sources":["Cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Cart.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <Container>\n    <el-divider></el-divider>\n    <el-row>\n      <el-col :span=\"2\">\n        <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n      </el-col>\n      <el-col :span=\"20\">\n        <div class=\"title\">\n          <p style=\"font-size: 1.2em; color: red;\">\n            <span class=\"el-icon-shopping-cart-full\">商品清单</span>\n          </p>\n        </div>\n      </el-col>\n    </el-row>\n    <!-- 详情展示区 -->\n    <el-row>\n      <el-col :span=\"2\">\n        <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n      </el-col>\n      <el-col :span=\"20\">\n        <div class=\"detail\">\n          <div>\n            <!-- 商品展示 -->\n            <el-table\n              :data=\"skus\"\n              size=\"mini\"\n              height=\"40em\"\n              highlight-cuurent-row\n              ref=\"skuList\"\n              :header-cell-style=\"{background:'#eef1f6',color:'#606266'}\"\n              :header-row-style=\"{height:'5em'}\"\n              @selection-change=\"handleSelectionChange\"\n              @row-click=\"handleRowClick\"\n            >\n              <el-table-column type=\"selection\" align=\"center\"></el-table-column>\n              <el-table-column width=\"150\" align=\"center\">\n                <template slot-scope=\"scope\">\n                  <el-image :src=\"scope.row.default_image_url\" style=\"width: 8em; height: 8em;\"></el-image>\n                </template>\n              </el-table-column>\n              <el-table-column prop=\"name\" label=\"商品名称\" width=\"300\" align=\"center\"></el-table-column>\n              <el-table-column prop=\"spec\" label=\"规格\" width=\"150\" align=\"center\"></el-table-column>\n              <el-table-column prop=\"price\" label=\"价格\" width=\"100\" align=\"center\"></el-table-column>\n              <el-table-column label=\"数量\" width=\"180\" align=\"center\">\n                <template slot-scope=\"scope\">\n                  <el-input-number\n                    v-model=\"scope.row.count\"\n                    :min=\"1\"\n                    :max=\"scope.row.stock\"\n                    size=\"mini\"\n                    @change=\"edit_cart(scope.row)\"\n                  ></el-input-number>\n                </template>\n              </el-table-column>\n              <el-table-column label=\"小计\" width=\"120\" align=\"center\">\n                <!-- 保留两位小数 -->\n                <template\n                  slot-scope=\"scope\"\n                >{{ (scope.row.count * scope.row.price).toFixed(2) }} &nbsp;元</template>\n              </el-table-column>\n              <el-table-column label=\"操作\" align=\"center\">\n                <template slot-scope=\"scope\">\n                  <el-button\n                    type=\"danger\"\n                    icon=\"el-icon-delete\"\n                    size=\"mini\"\n                    @click=\"delete_cart(scope.row)\"\n                  >删除</el-button>\n                </template>\n              </el-table-column>\n            </el-table>\n          </div>\n          <!-- 结算栏 -->\n          <div class=\"account\">\n            <el-col :span=\"15\">\n              <el-col :span=\"2\">\n                <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n              </el-col>\n              <el-col :span=\"4\">\n                <p style=\"font-size: 1.5em;color: red;\">结&nbsp;算</p>\n              </el-col>\n            </el-col>\n            <el-col :span=\"4\">\n              <p style=\"text-align: right;\">\n                <span style=\"font-size: 0.5em;\">合计（不含运费）：</span>\n                <span style=\"font-size: 0.5em; color: red;\">¥ &nbsp;</span>\n                <span style=\"font-size: 1.2em; color: red;\">{{ total_price }}</span>\n              </p>\n              <p style=\"font-size: 0.5em; text-align: right;\">\n                <span>共计</span>\n                <span style=\"color: red;\">&nbsp;{{ count }}&nbsp;</span>\n                <span>件商品</span>\n              </p>\n            </el-col>\n            <el-col :span=\"1\">\n              <pre style=\"margin:0; padding: 0;\">&nbsp;</pre>\n            </el-col>\n            <el-col :span=\"4\">\n              <div class=\"submit_button\">\n                <el-link\n                  style=\"color: white; font-size: 1.2em;\"\n                  :underline=\"false\"\n                  @click=\"to_create_order\"\n                >立&nbsp;即&nbsp;付&nbsp;款</el-link>\n              </div>\n            </el-col>\n          </div>\n        </div>\n      </el-col>\n    </el-row>\n  </Container>\n</template>\n<script>\n/* eslint-disable */\nimport Container from \"@/components/Container.vue\";\n\nexport default {\n  name: \"Cart\",\n  data() {\n    return {\n      // 查询结果\n      skus: [],\n\n      // 所有商品总价及数量\n      total_price: 0,\n      count: 0,\n\n      // 选中的sku\n      selected_skus: []\n    };\n  },\n  mounted() {\n    this.get_cart();\n  },\n  methods: {\n    // 获取购物车信息\n    get_cart() {\n      let that = this;\n      that.$axios.get(\"cart/\").then(res => {\n        that.skus = res.data;\n      });\n    },\n\n    // 勾选事件\n    handleSelectionChange(rows) {\n      this.count = 0;\n      this.total_price = 0;\n      this.selected_skus = rows;\n      rows.forEach(value => {\n        this.total_price += value.count * value.price;\n        this.count += value.count;\n      });\n    },\n\n    // 表格行点击事件，点击行就取消勾选状态并立即再次勾选，为了出发handleSelectionChange\n    handleRowClick(row) {\n      this.$refs.skuList.toggleRowSelection(row, false);\n      // this.$refs.skuList.toggleRowSelection(row, true);\n    },\n\n    // 修改购物车信息， 利用async 和 await 实现同步请求\n    edit_cart: function(row) {\n      // 准备数据\n      let request_data = {\n        sku_id: row.id,\n        count: row.count,\n        spec: row.spec\n      };\n\n      this.$axios.put(\"cart/\", {\n        data: request_data\n      });\n    },\n\n    // 删除购物车记录\n    delete_cart(row) {\n      this.$axios\n        .delete(\"cart/\", {\n          data: row\n        })\n        .then(res => {\n          if (res.status == 200) {\n            this.get_cart();\n          }\n        });\n    },\n\n    // 跳转至提交订单页面\n    to_create_order() {\n      if (this.selected_skus.length == 0) {\n        this.$notify.warning({\n          title: \"请先选择需要购买的商品\"\n        });\n        return;\n      }\n      if (this.$store.state.token == undefined) {\n        this.$notify.warning({\n          title: \"请先登陆\"\n        });\n        return;\n      }\n\n      // 准备数据\n      let request_data = [];\n      this.selected_skus.forEach((value, index) => {\n        let sku = {};\n        sku.sku_id = value.id;\n        sku.spec = value.spec;\n\n        request_data[index] = sku;\n      });\n      let params = { skus: request_data };\n\n      this.$api.selects(params).then(res => {\n        if (res.status == 201) {\n          this.$router.push({\n            name: \"create_order\"\n          });\n        }\n      });\n    }\n  },\n  components: {\n    Container\n  },\n  watch: {}\n};\n</script>\n<style  scoped>\n.el-divider {\n  margin: 0;\n  padding: 0;\n  width: 85%;\n  margin-left: 6.5em;\n}\n.el-row {\n  margin: 0 0;\n}\n.detail {\n  height: 35em;\n  background-color: rgb(248, 219, 156);\n}\n.submit_button {\n  background-color: rgb(236, 62, 62);\n  height: 5em;\n  line-height: 5em;\n  text-align: center;\n}\n</style>"]}]}