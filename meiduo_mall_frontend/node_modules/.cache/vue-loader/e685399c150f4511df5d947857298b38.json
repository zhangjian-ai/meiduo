{"remainingRequest":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/src/components/Address.vue?vue&type=style&index=0&id=43c5b3f4&scoped=true&lang=css&","dependencies":[{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/src/components/Address.vue","mtime":1622980272163},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangjian/PycharmProjects/meiduo/meiduo_mall_frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmVsLWRpdmlkZXIgewogIG1hcmdpbjogMC41ZW07CiAgbWFyZ2luLWxlZnQ6IDA7CiAgcGFkZGluZzogMDsKfQoudGlwIHsKICBmb250LXNpemU6IDAuNWVtOwogIG1hcmdpbjogMmVtOwp9Ci5lbC1yb3cgewogIG1hcmdpbjogMC4yNWVtOwp9Ci5kZXRhaWwgewogIGZvbnQtc2l6ZTogMC41ZW07CiAgYm9yZGVyOiAwLjVweCBzb2xpZCByZ2IoMTc2LCAxNzYsIDI0MCk7CiAgbWFyZ2luOiAwLjVlbTsKICBwYWRkaW5nOiAwLjVlbTsKICBib3JkZXItcmFkaXVzOiAwLjVlbTsKfQouZWwtaW5wdXQgewogIHdpZHRoOiAzMmVtOwogIG1hcmdpbi1yaWdodDogMWVtOwp9Ci5idXR0b24gewogIHRleHQtYWxpZ246IHJpZ2h0OwogIHBhZGRpbmctcmlnaHQ6IDNlbTsKfQouZWwtc2VsZWN0IHsKICB3aWR0aDogOGVtOwp9Cg=="},{"version":3,"sources":["Address.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Address.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <el-row>\n      <el-button type=\"primary\" icon=\"el-icon-plus\" size=\"mini\" @click=\"show_addrForm\">新增收货地址</el-button>\n      <span class=\"tip\">\n        当前已有\n        <span style=\"color: red; margin: 0.5em;\">{{ count }}</span>个收货地址，\n        最多添加\n        <span style=\"color: red; margin: 0.5em;\">{{ total }}</span>个收货地址\n      </span>\n    </el-row>\n    <el-divider></el-divider>\n    <!-- 收货地址列表 -->\n    <el-row v-for=\"(address, index) in addresses\" :key=\"address.title\">\n      <div class=\"detail\">\n        <el-row style=\"margin-left: 4em;\">\n          <el-col :span=\"22\">\n            <span v-if=\"is_set_title[index]\">\n              <el-input v-model=\"input_title\" placeholder=\"输入标题\" size=\"mini\"></el-input>&nbsp;\n              <el-button type=\"primary\" @click=\"edit_title(index)\" size=\"mini\">确认</el-button>\n              <el-button type=\"info\" @click=\"hide_edit_title\" size=\"mini\">取消</el-button>\n            </span>\n            <span v-else>\n              <span style=\"font-size: 2em;\">{{ address.title }}</span>\n              <el-button\n                type=\"text\"\n                size=\"mini\"\n                style=\"margin: 0 2em;\"\n                @click=\"show_edit_title(index)\"\n              >修改标题</el-button>\n              <span v-if=\"address.is_default\">\n                <el-tag type=\"danger\" effect=\"dark\" size=\"mini\">默认地址</el-tag>\n              </span>\n            </span>\n          </el-col>\n          <el-col :span=\"2\" style=\"text-align: right;\">\n            <el-link :underline=\"false\" @click=\"delete_address(index)\">\n              <i class=\"el-icon-close\"></i>\n            </el-link>\n          </el-col>\n        </el-row>\n        <el-row>\n          <el-row>\n            <el-col :span=\"3\" style=\"text-align: right;\">收货人：</el-col>\n            <el-col :span=\"14\" style=\"text-align: left;\">{{ address.receiver }}</el-col>\n          </el-row>\n          <el-row>\n            <el-col :span=\"3\" style=\"text-align: right;\">地区：</el-col>\n            <el-col\n              :span=\"14\"\n              style=\"text-align: left;\"\n            >{{ address.province }}&nbsp;{{ address.city }}&nbsp;{{ address.district }}</el-col>\n          </el-row>\n          <el-row>\n            <el-col :span=\"3\" style=\"text-align: right;\">详细地址：</el-col>\n            <el-col :span=\"14\" style=\"text-align: left;\">{{ address.place }}</el-col>\n          </el-row>\n          <el-row>\n            <el-col :span=\"3\" style=\"text-align: right;\">手机号：</el-col>\n            <el-col :span=\"14\" style=\"text-align: left;\">{{ address.mobile }}</el-col>\n          </el-row>\n          <el-row>\n            <el-col :span=\"3\" style=\"text-align: right;\">固定电话：</el-col>\n            <el-col :span=\"14\" style=\"text-align: left;\">{{ address.tel }}</el-col>\n          </el-row>\n          <el-row>\n            <el-col :span=\"3\" style=\"text-align: right;\">电子邮箱：</el-col>\n            <el-col :span=\"14\" style=\"text-align: left;\">{{ address.email }}</el-col>\n          </el-row>\n          <el-row>\n            <el-col :span=\"20\" style=\"text-align: right;\">\n              <el-button @click=\"edit_address(index)\" type=\"text\" size=\"mini\">\n                <i class=\"el-icon-edit\"></i>编辑修改\n              </el-button>\n            </el-col>\n            <el-col :span=\"3\" style=\"text-align: right;\">\n              <el-button @click=\"set_default_address(index)\" type=\"text\" size=\"mini\">设为默认地址</el-button>\n            </el-col>\n          </el-row>\n        </el-row>\n      </div>\n    </el-row>\n    <!-- 新增和修改地址表单 -->\n    <el-dialog :title=\"title\" :visible.sync=\"dialogVisible\" width=\"36em\">\n      <el-form :model=\"addrForm\" :rules=\"rules\" label-width=\"8em\" ref=\"addrForm\">\n        <el-form-item label=\"收件人：\" prop=\"receiver\">\n          <el-input v-model=\"addrForm.receiver\" size=\"mini\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"省市区：\" required>\n          <el-col :span=\"7\">\n            <el-form-item prop=\"province_id\">\n              <el-select v-model=\"addrForm.province_id\" size=\"mini\">\n                <el-option\n                  v-for=\"item in province\"\n                  :key=\"item.id\"\n                  :label=\"item.name\"\n                  :value=\"item.id\"\n                ></el-option>\n              </el-select>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"7\">\n            <el-form-item prop=\"city_id\">\n              <el-select v-model=\"addrForm.city_id\" size=\"mini\">\n                <el-option v-for=\"item in city\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\"></el-option>\n              </el-select>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"7\">\n            <el-form-item prop=\"district_id\">\n              <el-select v-model=\"addrForm.district_id\" size=\"mini\">\n                <el-option\n                  v-for=\"item in district\"\n                  :key=\"item.id\"\n                  :label=\"item.name\"\n                  :value=\"item.id\"\n                ></el-option>\n              </el-select>\n            </el-form-item>\n          </el-col>\n        </el-form-item>\n        <el-form-item label=\"详细地址：\" prop=\"place\">\n          <el-input v-model=\"addrForm.place\" size=\"mini\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"手机：\" prop=\"mobile\">\n          <el-input v-model=\"addrForm.mobile\" size=\"mini\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"固定电话：\" prop=\"tel\">\n          <el-input v-model=\"addrForm.tel\" size=\"mini\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"电子邮箱：\" prop=\"email\">\n          <el-input v-model=\"addrForm.email\" size=\"mini\"></el-input>\n        </el-form-item>\n      </el-form>\n      <span style=\"margin-left:28em;\">\n        <el-button @click=\"reset_addrForm\" size=\"mini\">重 置</el-button>\n        <el-button type=\"primary\" @click=\"submit\" size=\"mini\">提 交</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n<script>\nexport default {\n  name: \"Address\",\n  data() {\n    return {\n      // 收货地址数量\n      total: 0,\n      count: 0,\n\n      // 保存后端返回的地址列表\n      addresses: [],\n\n      // 修改标题\n      is_set_title: [],\n      input_title: \"\",\n\n      //展示表单\n      dialogVisible: false,\n      title: \"\",\n\n      // 省市区数据\n      province: [],\n      city: [],\n      district: [],\n\n      //表单\n      addrForm: {\n        receiver: \"\",\n        province_id: \"\",\n        city_id: \"\",\n        district_id: \"\",\n        place: \"\",\n        mobile: \"\",\n        tel: \"\",\n        email: \"\"\n      },\n\n      // 表单提交类型  0:新增  1:修改\n      type: 0,\n\n      //表单校验规则\n      rules: {\n        receiver: [\n          { required: true, message: \"收件人必填项\", trigger: \"blur\" }\n        ],\n        place: [{ required: true, message: \"收件人必填项\", trigger: \"blur\" }],\n        mobile: [\n          {\n            required: true,\n            pattern: /^1[3-9]{1}\\d{9}$/,\n            message: \"手机号码不合法\",\n            trigger: \"blur\"\n          }\n        ],\n        province_id: [{ required: true, message: \"请选择\", trigger: \"change\" }],\n        city_id: [{ required: true, message: \"请选择\", trigger: \"change\" }],\n        district_id: [{ required: true, message: \"请选择\", trigger: \"change\" }]\n      }\n    };\n  },\n  mounted() {\n    this.get_addrsss();\n    this.get_province();\n  },\n\n  methods: {\n    // 获取地址信息\n    get_addrsss() {\n      let that = this;\n      that.$axios\n        .get(\"address/\", {})\n        .then(res => {\n          that.total = res.data.limit;\n          that.addresses = res.data.address;\n          that.count = that.addresses.length;\n        })\n        .catch(err => {\n          this.$notify.error({\n            title: \"获取收货地址信息失败\",\n            message: err.msg\n          });\n        });\n    },\n    // 展示编辑标题\n    show_edit_title(index) {\n      this.input_title = this.addresses[index].title;\n      for (var i = 0; i < index; i++) {\n        this.is_set_title.push(false);\n      }\n      this.is_set_title.push(true);\n    },\n    // 隐藏编辑标题\n    hide_edit_title() {\n      this.is_set_title = [];\n    },\n    // 修改地址标题\n    edit_title(index) {\n      let that = this;\n      that.$axios\n        .put(\"edit_address_title/\", {\n          id: that.addresses[index].id,\n          title: that.input_title\n        })\n        .then(res => {\n          that.hide_edit_title();\n          that.get_addrsss();\n          that.$notify({\n            type: \"success\",\n            message: res.data.msg\n          });\n        })\n        .catch(err => {\n          this.$notify.error({\n            title: \"获取地址信息失败\",\n            message: err.message\n          });\n        });\n    },\n    // 删除地址\n    delete_address(index) {\n      let that = this;\n      that.$axios\n        .delete(\"address/\", {\n          data: {\n            id: that.addresses[index].id\n          }\n        })\n        .then(res => {\n          that.get_addrsss();\n          that.$notify({\n            type: \"success\",\n            message: res.data.msg\n          });\n        })\n        .catch(err => {\n          this.$notify.error({\n            title: \"获取地址信息失败\",\n            message: err.message\n          });\n        });\n    },\n    // 获取省级信息\n    get_province() {\n      let that = this;\n      that.$axios\n        .get(\"areas/\")\n        .then(res => {\n          that.province = res.data;\n        })\n        .catch(err => {\n          this.$notify.error({\n            title: \"获取省份信息失败\",\n            message: err.message\n          });\n        });\n    },\n    // 清空表单数据\n    reset_addrForm() {\n      // 重置表单校验,mouted加载table数据以后，隐藏的弹出框并没有编译渲染紧DOM里\n      // 只能重置带有prop且为字段名的表单项\n      if (this.$refs.addrForm !== undefined) {\n        this.$refs.addrForm.resetFields();\n      }\n    },\n    // 新增地址\n    show_addrForm() {\n      this.reset_addrForm();\n      this.dialogVisible = true;\n      this.type = 0;\n      this.title = \"新增地址\"\n    },\n    // 提交表单\n    submit() {\n      let that = this;\n      that.$refs.addrForm.validate(valid => {\n        if (valid) {\n          if (that.type === 0) {\n            that.$axios\n              .post(\"address/\", that.addrForm)\n              .then(res => {\n                that.$notify({\n                  type: \"success\",\n                  message: res.data.msg\n                });\n                that.get_addrsss();\n                that.dialogVisible = false;\n              })\n              .catch(err => {\n                this.$notify.error({\n                  title: \"新增地址信息失败\",\n                  message: err.message\n                });\n              });\n          }\n          if (that.type === 1) {\n            that.$axios\n              .put(\"address/\", that.addrForm)\n              .then(res => {\n                that.$notify({\n                  type: \"success\",\n                  message: res.data.msg\n                });\n                that.get_addrsss();\n                that.dialogVisible = false;\n              })\n              .catch(err => {\n                this.$notify.error({\n                  title: \"修改地址信息失败\",\n                  message: err.message\n                });\n              });\n          }\n        } else {\n          return false;\n        }\n      });\n    },\n    // 修改收货地址\n    edit_address(index) {\n      let that = this;\n      // 回填表单\n      that.addrForm.receiver = that.addresses[index].receiver;\n      that.addrForm.province_id = that.addresses[index].province_id;\n      that.addrForm.city_id = that.addresses[index].city_id;\n      that.addrForm.district_id = that.addresses[index].district_id;\n      that.addrForm.place = that.addresses[index].place;\n      that.addrForm.mobile = that.addresses[index].mobile;\n      that.addrForm.tel = that.addresses[index].tel;\n      that.addrForm.email = that.addresses[index].email;\n      // 修改地址时，加入地址id\n      that.addrForm.id = that.addresses[index].id;\n      that.addrForm.title = that.addresses[index].title;\n\n      that.dialogVisible = true;\n      that.title = \"修改收货地址\";\n      that.type = 1;\n    },\n    // 设为默认地址\n    set_default_address(index) {\n      let that = this;\n      if (that.addresses[index].is_default === true) {\n        this.$notify({\n          type: \"warning\",\n          message: \"当前地址已经是默认地址\"\n        });\n        return;\n      }\n      that.$axios\n        .put(\"address/\", {\n          id: that.addresses[index].id,\n          is_default: true\n        })\n        .then(res => {\n          that.$notify({\n            type: \"success\",\n            message: res.data.msg\n          });\n          that.get_addrsss();\n        })\n        .catch(err => {\n          this.$notify.error({\n            title: \"设置默认地址失败\",\n            message: err.msg\n          });\n        });\n    }\n  },\n  // 监听：选择了省就查市，选择了市就查区\n  watch: {\n    \"addrForm.province_id\": function() {\n      let that = this;\n      if (that.addrForm.province_id) {\n        that.$axios\n          .get(\"areas/\" + that.addrForm.province_id + \"/\")\n          .then(res => {\n            that.city = res.data.subs;\n            that.district = [];\n          })\n          .catch(err => {\n            that.$notify.error({\n              title: \"获取城市信息失败\",\n              message: err.message\n            });\n            that.city = [];\n            that.district = [];\n          });\n      }\n    },\n    \"addrForm.city_id\": function() {\n      let that = this;\n      if (that.addrForm.city_id) {\n        that.$axios\n          .get(\"areas/\" + that.addrForm.city_id + \"/\")\n          .then(res => {\n            that.district = res.data.subs;\n          })\n          .catch(err => {\n            that.$notify.error({\n              title: \"获取城区信息失败\",\n              message: err.message\n            });\n            that.district = [];\n          });\n      }\n    }\n  }\n};\n</script>\n<style scoped>\n.el-divider {\n  margin: 0.5em;\n  margin-left: 0;\n  padding: 0;\n}\n.tip {\n  font-size: 0.5em;\n  margin: 2em;\n}\n.el-row {\n  margin: 0.25em;\n}\n.detail {\n  font-size: 0.5em;\n  border: 0.5px solid rgb(176, 176, 240);\n  margin: 0.5em;\n  padding: 0.5em;\n  border-radius: 0.5em;\n}\n.el-input {\n  width: 32em;\n  margin-right: 1em;\n}\n.button {\n  text-align: right;\n  padding-right: 3em;\n}\n.el-select {\n  width: 8em;\n}\n</style>"]}]}